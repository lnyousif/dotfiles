#!/bin/bash

# Define the cron jobs you want to add.
# Ensure you use full paths for the commands and scripts.
JOBS=(
    "0 */2 * * * /bin/bash ~/.cloudflare-ddns-updater/cloudflare.sh"
    "0 */2 * * * /bin/bash ~/.cloudflare-ddns-updater/cloudflarev6.sh"
)

# Get current crontab content or an empty string if none exists
(crontab -l 2>/dev/null || :) | while IFS= read -r line; do
    echo "$line"
done > /tmp/current_crontab.tmp

# Loop through the jobs and add them if they don't exist
for job in "${JOBS[@]}"; do
    if ! grep -Fq "$job" /tmp/current_crontab.tmp; then
        echo "Adding new cron job: $job"
        echo "$job" >> /tmp/current_crontab.tmp
    else
        echo "Job already exists, skipping: $job"
    fi
done

# Install the updated crontab file
crontab /tmp/current_crontab.tmp
rm /tmp/current_crontab.tmp

echo "Crontab configuration complete."
